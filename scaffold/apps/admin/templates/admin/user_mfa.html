{% extends "base.html" %}
{% block title %}{{ _('admin.user_mfa.title') }}{% endblock %}
{% block content %}
<div class="mb-4">
  <h1 class="text-xl font-bold mb-1">{{ _('admin.user_mfa.heading', name=target_user.full_name) }}</h1>
  <p class="text-[var(--color-muted)] mb-0">{{ _('admin.user_mfa.email') }}: {{ target_user.email }}</p>
</div>

{% if provisioning %}
  <div class="bg-[var(--color-card)] border border-[var(--color-border)] rounded-xl shadow-sm mb-4">
    <div class="px-5 py-4">
  <h2 class="text-lg font-semibold mb-2">{{ _('admin.user_mfa.provisioning.heading') }}</h2>
  <p class="mb-1"><span class="text-[var(--color-muted)]">{{ _('admin.user_mfa.provisioning.secret') }}:</span> <code class="bg-black/20 px-1 py-0.5 rounded">{{ provisioning.secret }}</code></p>
  <p class="mb-0"><span class="text-[var(--color-muted)]">{{ _('admin.user_mfa.provisioning.uri') }}:</span> <code class="bg-black/20 px-1 py-0.5 rounded">{{ provisioning.uri }}</code></p>
    </div>
  </div>
{% else %}
  <div class="rounded-xl px-4 py-3 text-sm border bg-blue-500/10 border-blue-400/40 text-blue-200 mb-4">{{ _('admin.user_mfa.not_provisioned') }}</div>
{% endif %}

<div class="flex flex-wrap gap-2">
  <form method="post" class="inline">
    {% if csrf_token is defined %}{{ csrf_token() }}{% endif %}
    <input type="hidden" name="action" value="enable">
    <button type="submit" class="inline-flex items-center justify-center font-medium rounded-md px-4 py-2 text-sm transition-colors border border-green-500/50 text-green-500 hover:bg-green-500/10 px-2.5 py-1 text-xs">{{ _('admin.user_mfa.actions.enable_refresh') }}</button>
  </form>
  <form method="post" class="inline">
    {% if csrf_token is defined %}{{ csrf_token() }}{% endif %}
    <input type="hidden" name="action" value="regenerate">
    <button type="submit" class="inline-flex items-center justify-center font-medium rounded-md px-4 py-2 text-sm transition-colors border border-yellow-400 text-yellow-400 hover:bg-yellow-400/10 px-2.5 py-1 text-xs">{{ _('admin.user_mfa.actions.regenerate') }}</button>
  </form>
  <form method="post" class="inline">
    {% if csrf_token is defined %}{{ csrf_token() }}{% endif %}
    <input type="hidden" name="action" value="disable">
    <button type="submit" class="inline-flex items-center justify-center font-medium rounded-md px-4 py-2 text-sm transition-colors border border-red-400 text-red-400 hover:bg-red-400/10 px-2.5 py-1 text-xs">{{ _('admin.user_mfa.actions.disable') }}</button>
  </form>
  <a class="inline-flex items-center justify-center font-medium rounded-md px-4 py-2 text-sm transition-colors border border-[var(--color-border)] text-[var(--color-text)] hover:bg-white/8 px-2.5 py-1 text-xs" href="{{ url_for('admin.list_users') }}">{{ _('admin.user_mfa.actions.back_to_users') }}</a>
</div>
{% endblock %}
