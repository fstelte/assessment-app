# Docker Compose project naming (used when running docker compose from the repo root)
COMPOSE_PROJECT_NAME=assessment_app

# Copy to ../.env.production and adjust per environment
FLASK_ENV=production
# Generate with: openssl rand -hex 32
SECRET_KEY=
SCAFFOLD_APP_MODULES=scaffold.apps.auth.routes,scaffold.apps.admin,scaffold.apps.bia,scaffold.apps.csa,scaffold.apps.template,scaffold.apps.dpia
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Lax
# Keep local login available alongside SAML
PASSWORD_LOGIN_ENABLED=true
BIA_COMPONENTS_PER_PAGE=25
PREFERRED_URL_SCHEME=https
PROXY_FIX_ENABLED=true
PROXY_FIX_X_FOR=1
PROXY_FIX_X_PROTO=1
PROXY_FIX_X_HOST=1
PROXY_FIX_X_PORT=0
PROXY_FIX_X_PREFIX=0
PORT=8000
# Docker image tag for deployments using GHCR compose file
APP_IMAGE=ghcr.io/fstelte/assessment-app:latest

# Compose profiles (comma-separated). Include "postgres", "fail2ban", "crowdsec" as needed.
COMPOSE_PROFILES=

# Automated TLS via certbot (compose.certbot.yml)
CERTBOT_ENABLED=false
CERTBOT_EMAIL=
CERTBOT_PRIMARY_DOMAIN=
# Optional: comma- or space-separated list of SANs (e.g. www.example.com,admin.example.com)
CERTBOT_ADDITIONAL_DOMAINS=
CERTBOT_FORCE_HTTPS=true
CERTBOT_STAGING=false
CERTBOT_RENEW_INTERVAL=43200
CERTBOT_RSA_KEY_SIZE=4096

# Fail2Ban hardening (compose.security.yml; add "fail2ban" to COMPOSE_PROFILES)
FAIL2BAN_MAXRETRY=5
FAIL2BAN_FINDTIME=600
FAIL2BAN_BANTIME=3600
FAIL2BAN_IGNORE_IPS=127.0.0.1/8
FAIL2BAN_NGINX_ACCESS_LOG=/var/log/nginx/access.log
FAIL2BAN_NGINX_ERROR_LOG=/var/log/nginx/error.log
FAIL2BAN_BOTSEARCH_ENABLED=true

# CrowdSec collaborative defence (compose.security.yml; add "crowdsec" to COMPOSE_PROFILES)
CROWDSEC_COLLECTIONS=crowdsecurity/nginx
CROWDSEC_ENROLL_KEY=
CROWDSEC_ENROLL_INSTANCE_ID=
CROWDSEC_LAPI_DEFAULT_PASSWORD=
CROWDSEC_LAPI_URL=http://127.0.0.1:8080/
CROWDSEC_NGINX_ACCESS_LOG=/var/log/nginx/access.log
CROWDSEC_BOUNCER_API_URL=http://127.0.0.1:8080/
CROWDSEC_BOUNCER_API_KEY=
CROWDSEC_BOUNCER_LOG_LEVEL=info
CROWDSEC_FIREWALL_BOUNCER_MODE=iptables
CROWDSEC_FIREWALL_BOUNCER_IPSET=crowdsec-blacklists
CROWDSEC_FIREWALL_BOUNCER_IPSET_V6=crowdsec6-blacklists
CROWDSEC_DISABLE_IPV6=true

# Export artefact cleanup (runs in background when enabled)
EXPORT_CLEANUP_ENABLED=false
EXPORT_CLEANUP_MAX_AGE_DAYS=7
EXPORT_CLEANUP_INTERVAL_MINUTES=60

# Audit trail retention (handled within the web process; defaults align with BACKUP_DIR/logs)
AUDIT_LOG_ENABLED=true
AUDIT_LOG_PATH=/logging/logs/audit.log
AUDIT_LOG_RETENTION_DAYS=90
AUDIT_LOG_PRUNE_INTERVAL_HOURS=24
# Optional JSON mapping to override automatic ORM audit listeners
# Example capturing all core models:
# {"scaffold.apps.identity.models.User":{"entity":"user","fields":["email","status","first_name","last_name","is_service_account","locale_preference","theme_preference"],"operations":["insert","update","delete"],"identity_field":"id","fallback_identity":["email"]},"scaffold.apps.identity.models.Role":{"entity":"role","fields":["name","description"],"operations":["insert","update","delete"],"identity_field":"id","fallback_identity":["name"]},"scaffold.apps.bia.models.ContextScope":{"entity":"bia.context_scope","fields":["name","responsible","risk_owner","security_manager","last_update","scope_description"],"operations":["insert","update","delete"],"identity_field":"id","fallback_identity":["name"]},"scaffold.apps.bia.models.Component":{"entity":"bia.component","fields":["name","info_type","info_owner","user_type","process_dependencies","description","authentication_method_id"],"operations":["insert","update","delete"],"identity_field":"id","fallback_identity":["name"]},"scaffold.apps.bia.models.Consequences":{"entity":"bia.consequence","fields":["component_id","consequence_category","security_property","consequence_worstcase","consequence_realisticcase"],"operations":["insert","update","delete"],"identity_field":"id"},"scaffold.apps.bia.models.AIIdentificatie":{"entity":"bia.ai_identificatie","fields":["component_id","category","motivation"],"operations":["insert","update","delete"],"identity_field":"id"},"scaffold.apps.bia.models.AvailabilityRequirements":{"entity":"bia.availability","fields":["component_id","mtd","rto","rpo","masl"],"operations":["insert","update","delete"],"identity_field":"id"},"scaffold.apps.bia.models.Summary":{"entity":"bia.summary","fields":["context_scope_id","summary"],"operations":["insert","update","delete"],"identity_field":"id"},"scaffold.apps.csa.models.Assessment":{"entity":"csa.assessment","fields":["title","status","due_date","template_id","created_by_id"],"operations":["insert","update","delete"],"identity_field":"id"},"scaffold.apps.csa.models.AssessmentAssignment":{"entity":"csa.assignment","fields":["assessment_id","assignee_id","status"],"operations":["insert","update","delete"],"identity_field":"id"},"scaffold.apps.csa.models.AssessmentResponse":{"entity":"csa.response","fields":["assessment_id","question_id","answer","justification"],"operations":["insert","update","delete"],"identity_field":"id"},"scaffold.apps.csa.models.Control":{"entity":"csa.control","fields":["name","reference","category","status"],"operations":["insert","update","delete"],"identity_field":"id"},"scaffold.apps.csa.models.AuditTrail":{"entity":"csa.audit_trail","fields":["action","actor_id","details"],"operations":["insert","update","delete"],"identity_field":"id"},"scaffold.apps.dpia.models.DPIAAssessment":{"entity":"dpia.assessment","fields":["title","status","owner_id"],"operations":["insert","update","delete"],"identity_field":"id"},"scaffold.apps.identity.models.MFASetting":{"entity":"mfa.setting","fields":["user_id","enabled","enrolled_at"],"operations":["insert","update","delete"],"identity_field":"id"}}
AUDIT_LOG_MODEL_EVENTS=
# Run `flask --app scaffold:create_app audit-retention` for on-demand cleanup

# SAML single sign-on settings
SAML_SP_ENTITY_ID=https://example.com/saml/metadata
SAML_SP_ACS_URL=https://example.com/auth/login/saml/acs
SAML_SP_SLS_URL=https://example.com/auth/login/saml/sls
# Optional: embed PEM-encoded certificate/private key if signing requests
SAML_SP_CERT=
SAML_SP_PRIVATE_KEY=
SAML_IDP_ENTITY_ID=
SAML_IDP_SSO_URL=
SAML_IDP_SLO_URL=
# Paste base64 content without PEM markers or whitespace.
SAML_IDP_CERT=
# For rotations, provide comma- or newline-separated base64 strings (without PEM markers).
SAML_IDP_CERT_MULTI=
SAML_NAMEID_FORMAT=urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified
SAML_SIGN_AUTHN_REQUESTS=false
SAML_SIGN_LOGOUT_REQUESTS=false
SAML_SIGN_LOGOUT_RESPONSES=false
SAML_WANT_MESSAGE_SIGNED=false
SAML_WANT_ASSERTION_SIGNED=true
SAML_LOGOUT_RETURN_URL=
SAML_ALLOWED_GROUP_IDS=
# JSON object mapping Entra group IDs (lowercase GUIDs) to one or more role names
# Example: {"00000000-0000-0000-0000-000000000000": ["admin", "manager"]}
SAML_ROLE_MAP=
# Optional: store Entra group â†’ role mappings in the database (overrides env map when present)
# Set to true if using the admin UI to configure mappings dynamically.
ENTRA_ROLE_MAP_USE_DB=true
SAML_ATTRIBUTE_GROUPS=http://schemas.microsoft.com/ws/2008/06/identity/claims/groups
SAML_ATTRIBUTE_EMAIL=http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress
SAML_ATTRIBUTE_FIRST_NAME=http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname
SAML_ATTRIBUTE_LAST_NAME=http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname
SAML_ATTRIBUTE_DISPLAY_NAME=http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name
SAML_ATTRIBUTE_OBJECT_ID=http://schemas.microsoft.com/identity/claims/objectidentifier
SAML_ATTRIBUTE_UPN=http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn
SAML_STRICT=true
SAML_DEBUG=false
# Comma-separated AuthnContext URNs; set to 'none' to omit the element
SAML_REQUESTED_AUTHN_CONTEXT=none
# Valid values: exact, minimum, better, maximum (Microsoft Entra expects 'exact')
SAML_REQUESTED_AUTHN_CONTEXT_COMPARISON=exact

# Postgres defaults for the bundled compose file
POSTGRES_DB=scaffold
POSTGRES_USER=scaffold
POSTGRES_PASSWORD=scaffold
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
DATABASE_URL=postgresql+psycopg://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# Automated restore service
RESTORE_WATCH_DIR=/restore/incoming
RESTORE_STATE_FILE=/restore/state/restore-state.json
RESTORE_POLL_INTERVAL=30
RESTORE_STOP_CONTAINERS=assessment_app-web-1
RESTORE_START_CONTAINERS=
RESTORE_STOP_TIMEOUT=30
RESTORE_STOP_WAIT_SECONDS=5
RESTORE_START_WAIT_SECONDS=5
RESTORE_SQLITE_BASE=/app
RESTORE_SQLITE_PATH=
MAINTENANCE_CONTACT_EMAIL=support@example.com
MAINTENANCE_CONTACT_LABEL=Support Team
MAINTENANCE_CONTACT_LINK=

