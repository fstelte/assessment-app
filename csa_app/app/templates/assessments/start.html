{% extends "base.html" %}
{% block title %}Nieuwe self-assessment{% endblock %}
{% block content %}
  <div class="row justify-content-center">
    <div class="col-lg-6">
      <h1 class="mb-4">Start een self-assessment</h1>
      <form method="post" novalidate>
        {{ form.hidden_tag() }}
        <div class="mb-3">
          {{ form.template_id.label(class="form-label") }}
          {{ form.template_id(class="form-select") }}
          {% for error in form.template_id.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
          <div class="form-text">Selecteer het sjabloon dat overeenkomt met de control die u wilt beoordelen.</div>
        </div>
        <div class="text-end">
          {{ form.submit(class="btn btn-primary") }}
        </div>
      </form>
      <div class="mt-4">
  <h2 class="h5">Beschikbare sjablonen</h2>
        <ul class="list-group">
          {% for template in templates %}
            <li class="list-group-item">
              {% set control_display = template.control and ([template.control.section, template.control.domain] | select('string') | join(' ')) %}
              <strong>
                {% if template.control %}
                  {{ control_display or template.name }}
                {% else %}
                  {{ template.name }}
                {% endif %}
              </strong>
              {% if template.control %}
                {% if template.control.section %}
                  <div class="text-muted small">Code: {{ template.control.section }}</div>
                {% endif %}
                {% if template.control.domain %}
                  <div class="text-muted small">Control: {{ template.control.domain }}</div>
                {% endif %}
                {% if template.name and template.name != (control_display or template.name) %}
                  <div class="text-muted small">Sjabloon: {{ template.name }}</div>
                {% endif %}
                {% if template.control.description %}
                  <div class="small text-muted">{{ template.control.description }}</div>
                {% endif %}
              {% endif %}
              <div class="small text-muted">Versie {{ template.version }}</div>
            </li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
{% endblock %}
