{% extends "base.html" %}
{% block title %}MFA Beheer{% endblock %}
{% block content %}
  <h1 class="mb-4">MFA voor {{ target_user.full_name }}</h1>
  <dl class="row">
    <dt class="col-sm-3">E-mail</dt>
    <dd class="col-sm-9">{{ target_user.email }}</dd>
    <dt class="col-sm-3">Status</dt>
    <dd class="col-sm-9">{{ 'Ingeschakeld' if target_user.mfa_is_enabled else 'Uitgeschakeld' }}</dd>
    <dt class="col-sm-3">Enrollment</dt>
    <dd class="col-sm-9">
      {% if target_user.mfa_setting and target_user.mfa_setting.enrolled_at %}
        {{ target_user.mfa_setting.enrolled_at }}
      {% else %}
        Niet geactiveerd
      {% endif %}
    </dd>
  </dl>

  <form method="post" class="d-flex gap-2 mb-4">
    <button type="submit" name="action" value="enable" class="btn btn-success">MFA inschakelen</button>
    <button type="submit" name="action" value="regenerate" class="btn btn-warning">Secret vernieuwen</button>
    <button type="submit" name="action" value="disable" class="btn btn-outline-danger">MFA uitschakelen</button>
  </form>

  {% if provisioning %}
    <div class="card">
      <div class="card-body">
        <h2 class="h5">Huidig secret</h2>
        <code class="d-block fs-5">{{ provisioning.secret }}</code>
        <p class="mt-3 mb-1">Provisioning URI</p>
        <textarea class="form-control" rows="3" readonly>{{ provisioning.uri }}</textarea>
        <p class="mt-3">Deel dit secret veilig met de gebruiker. De gebruiker zal tijdens de volgende login worden gevraagd om te enrolen of een MFA-code in te voeren.</p>
      </div>
    </div>
  {% endif %}
{% endblock %}
